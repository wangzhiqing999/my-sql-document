<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=GBK" />
  <title> 数据库链接 - MySQL </title>
  <link href="Common.css" rel="stylesheet" type="text/css" />
</head>

<body>


<h1> 数据库链接 </h1>


<h2> MySQL  </h2>

MySQL 数据库链接，需要首先下载好 MySQL 的 ODBC 驱动，并安装配置好，


<table border="1" style="width:100%">

  <tr>
    <td> Oracle </td>
    <td>
<pre><code>


首先，在 
D:\oracle\product\10.2.0\db_1\hs\admin
下，创建一个  initmysqltest.ora  文件， 内容包含
HS_FDS_CONNECT_INFO = MySQLTest 
HS_FDS_TRACE_LEVEL = 0


然后，在
D:\oracle\product\10.2.0\db_1\NETWORK\ADMIN
下，修改 listener.ora 文件

# listener.ora Network Configuration File: D:\oracle\product\10.2.0\db_1\NETWORK\ADMIN\listener.ora
# Generated by Oracle configuration tools.

SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME = PLSExtProc)
      (ORACLE_HOME = D:\oracle\product\10.2.0\db_1)
      (PROGRAM = extproc)
    )
    (SID_DESC =
      (SID_NAME = mysqltest)
      (ORACLE_HOME = D:\oracle\product\10.2.0\db_1)
      (PROGRAM = hsodbc)
    )
  )

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))
    )
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = ORCL-10)(PORT = 1521))
    )
  )


然后，在
D:\oracle\product\10.2.0\db_1\NETWORK\ADMIN
下，修改 tnsnames.ora 文件

# tnsnames.ora Network Configuration File: D:\oracle\product\10.2.0\db_1\network\admin\tnsnames.ora
# Generated by Oracle configuration tools.

ORCL =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = ORCL-10)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = orcl)
    )
  )

EXTPROC_CONNECTION_DATA =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))
    )
    (CONNECT_DATA =
      (SID = PLSExtProc)
      (PRESENTATION = RO)
    )
  )


mysqltest =
    (DESCRIPTION =
      (ADDRESS_LIST =
        (ADDRESS = (PROTOCOL = TCP)(HOST = ORCL-10)(PORT = 1521)) 
      )
      (CONNECT_DATA =
         (SID=mysqltest)
      )
      (HS =ok)
    )


重新启动 Listener服务后，在 SQL Plus 中

SQL> create public database link mysqllink
  2    connect to "root"
  3    identified by "mysql"
  4    using 'mysqltest';

数据库链接已创建。

SQL> select * from "demo"@mysqllink;

        id        val
---------- ----------
1	1

或者直接
SQL> CREATE DATABASE LINK mysqldblink
  2  CONNECT TO "root" IDENTIFIED BY "mysql"
  3  USING '(DESCRIPTION =
  4        (ADDRESS_LIST =
  5          (ADDRESS = (PROTOCOL = TCP)(HOST = ORCL-10)(PORT = 1521)) 
  6        )
  7        (CONNECT_DATA =
  8           (SID=mysqltest)
  9        )
 10        (HS =ok)
 11      )';

数据库链接已创建。

SQL> select * from demo@mysqldblink;

        id        val
---------- ----------
         1          1


</code></pre>
    </td>
  </tr>





  <tr>
    <td> DB2 </td>
    <td>
<pre><code>


</code></pre>
    </td>
  </tr>





  <tr>
    <td> SQL Server </td>
    <td>
<pre><code>


USE [master]
GO
EXEC master.dbo.sp_addlinkedserver @server = N'TESTMYSQL', @srvproduct=N'MySQL ODBC 5.1 driver', @provider=N'MSDASQL', @datasrc=N'MySQLTest'
GO
EXEC master.dbo.sp_serveroption @server=N'TESTMYSQL', @optname=N'collation compatible', @optvalue=N'false'
GO
EXEC master.dbo.sp_serveroption @server=N'TESTMYSQL', @optname=N'data access', @optvalue=N'true'
GO
EXEC master.dbo.sp_serveroption @server=N'TESTMYSQL', @optname=N'rpc', @optvalue=N'false'
GO
EXEC master.dbo.sp_serveroption @server=N'TESTMYSQL', @optname=N'rpc out', @optvalue=N'false'
GO
EXEC master.dbo.sp_serveroption @server=N'TESTMYSQL', @optname=N'connect timeout', @optvalue=N'0'
GO
EXEC master.dbo.sp_serveroption @server=N'TESTMYSQL', @optname=N'collation name', @optvalue=null
GO
EXEC master.dbo.sp_serveroption @server=N'TESTMYSQL', @optname=N'query timeout', @optvalue=N'0'
GO
EXEC master.dbo.sp_serveroption @server=N'TESTMYSQL', @optname=N'use remote collation', @optvalue=N'true'
GO
USE [master]
GO
EXEC master.dbo.sp_addlinkedsrvlogin @rmtsrvname = N'TESTMYSQL', @locallogin = NULL , @useself = N'False', @rmtuser = N'root', @rmtpassword = N'mysql'
GO

创建完毕后

select TOP 5 * from 
openquery(
  TESTMYSQL, 
  'select * from sale_report')



</code></pre>
    </td>
  </tr>





  <tr>
    <td> MySQL</td>
    <td>
<pre><code>


</code></pre>
    </td>
  </tr>






  <tr>
    <td> SQLite </td>
    <td>
<pre><code>


</code></pre>
    </td>
  </tr>

</table>




</body>


</html>
